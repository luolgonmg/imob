{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import QRCode from\"qrcode.react\";import toastError from\"../../errors/toastError\";import{Dialog,DialogContent,Paper,Typography}from\"@material-ui/core\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import{socketConnection}from\"../../services/socket\";const QrcodeModal=_ref=>{let{open,onClose,whatsAppId}=_ref;const[qrCode,setQrCode]=useState(\"\");useEffect(()=>{const fetchSession=async()=>{if(!whatsAppId)return;try{const{data}=await api.get(\"/whatsapp/\".concat(whatsAppId));setQrCode(data.qrcode);}catch(err){toastError(err);}};fetchSession();},[whatsAppId]);useEffect(()=>{if(!whatsAppId)return;const companyId=localStorage.getItem(\"companyId\");const socket=socketConnection({companyId});socket.on(\"company-\".concat(companyId,\"-whatsappSession\"),data=>{if(data.action===\"update\"&&data.session.id===whatsAppId){setQrCode(data.session.qrcode);}if(data.action===\"update\"&&data.session.qrcode===\"\"){onClose();}});return()=>{socket.disconnect();};},[whatsAppId,onClose]);return/*#__PURE__*/React.createElement(Dialog,{open:open,onClose:onClose,maxWidth:\"lg\",scroll:\"paper\"},/*#__PURE__*/React.createElement(DialogContent,null,/*#__PURE__*/React.createElement(Paper,{elevation:0},/*#__PURE__*/React.createElement(Typography,{color:\"primary\",gutterBottom:true},i18n.t(\"qrCode.message\")),qrCode?/*#__PURE__*/React.createElement(QRCode,{value:qrCode,size:256}):/*#__PURE__*/React.createElement(\"span\",null,\"Waiting for QR Code\"))));};export default React.memo(QrcodeModal);","map":null,"metadata":{},"sourceType":"module"}